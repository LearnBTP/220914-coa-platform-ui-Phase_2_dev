<mvc:View
    controllerName="coasublineui.controller.SubLine"
    xmlns:mvc="sap.ui.core.mvc"
    displayBlock="true"
    xmlns="sap.m"
    xmlns:core="sap.ui.core"
    xmlns:f="sap.f"
    xmlns:smartFilterBar="sap.ui.comp.smartfilterbar"
    xmlns:smartVariantManagement="sap.ui.comp.smartvariants"
    xmlns:app="http://schemas.sap.com/sapui5/extension/sap.ui.core.CustomData/1"
    xmlns:smartTable="sap.ui.comp.smarttable"
    xmlns:u="sap.ui.unified"
    xmlns:t="sap.ui.table"
>
    <f:DynamicPage id="SubPageDynamic" preserveHeaderStateOnScroll="true" headerExpanded="true" class="zDynamicPage" toggleHeaderOnTitleClick="false">
        <f:header>
            <f:DynamicPageHeader id='DPH' class="zDynamicPageHeader">
                <Title id="Title" text="COA - SubLine Plan" />
                <f:content>
                    <smartFilterBar:SmartFilterBar
                        id="smartFilterBar"
                        showGoOnFB="true"
                        useToolbar="false"
                        entitySet="CarryoverSubline"
                        showClearOnFB="true"
                        enableBasicSearch="false"
                        class="contrastTextSF appleSFPrimaryBtn appleSFSecondaryBtn"
                        search="onSearch"
                    >
                        <smartFilterBar:groupConfiguration>
                            <smartFilterBar:GroupConfiguration id='GC' index="1" key="CarryoverSubline" label="Input Parameters" />
                        </smartFilterBar:groupConfiguration>
                        <smartFilterBar:controlConfiguration>
                            <smartFilterBar:ControlConfiguration
                                id="chgAt"
                                key="modifiedAt"
                                index="5"
                                conditionType="{ module: 'sap.ui.comp.config.condition.DateRangeType', 
                                                         operations: { 
                                                            filter: [ {path: 'key', contains: 'YEAR',exclude:true},
                                                                      {path: 'key', contains: 'TIME',exclude:true},
                                                                      {path: 'key', contains: 'DATE'}
                                                                        ] } }"
                                visibleInAdvancedArea="true"
                            />
                        </smartFilterBar:controlConfiguration>
                        <smartFilterBar:layoutData>
                            <FlexItemData id='smartLayout' shrinkFactor="0" baseSize="0%" />
                        </smartFilterBar:layoutData>
                    </smartFilterBar:SmartFilterBar>
                </f:content>
            </f:DynamicPageHeader>
        </f:header>
        <f:content>
            <VBox id="VboxContent" height="100%">
                <items>
                    <FlexBox id="table" alignItems="Center" justifyContent="Center" height="100%">
                        <smartTable:SmartTable
                            xmlns:sap.ui.comp.smarttable="sap.ui.comp.smarttable"
                            id="SubLineTab"
                            tableBindingPath="coa>/SubLine"
                            header="SubLine"
                            fitContainer="true"
                            enableAutoBinding="false"
                            width="100%"
                            direction="Column"
                            requestAtLeastFields="CM,Site,Program,Edit"
                            height="100%"
                            class="sapUiSmallMarginBeginEnd zTable zTableTrEdit zMultiSelectEdit buttonWithIconOnly"
                            app:p13nDialogSettings="{group:{visible:false}}"
                            showRowCount="true"
                            enableAutoColumnWidth="true"
                            entitySet="CarryoverSubline"
                            initiallyVisibleFields="Program,Uph,Sub_Line_Name,boH_Qty,Fatp_Sustaining_Qty,Remote_Site_Cap_Demand,Yield,SubLine_UPH,Working_Hrs,Efficiency_Field,Comment,modifiedAt,modifiedBy_Name,createdAt,createdBy_Name,Error"
                            ignoredFields="Date,Upload_By_User,SAP_CM_Site"
                            placeToolbarInTable="true"
                            showFullScreenButton="true"
                            visible="true"
                            app:useSmartToggle="true"
                            app:useSmartField="false"
                            editToggled="onEditToggle"
                            editTogglable="{coa>/EditRole}"
                            useVariantManagement="false" showVariantManagement="false"
                            useTablePersonalisation="true"
                            enableExport="true"
                            beforeRebindTable="onSmartTableInit"
                            fieldChange="OnFieldChange"
                            initialise="onSmartTableInit"
                            beforeExport=".onBeforeExportSubLine"
                        >
                            <sap.ui.comp.smarttable:customData>
                                <core:CustomData key="dateFormatSettings" value='\{"UTC":true\}' />
                            </sap.ui.comp.smarttable:customData>
                            <smartTable:customToolbar>
                                <OverflowToolbar id="OTT" design="Transparent">
                                    <ToolbarSpacer id='TS' />
                                    <OverflowToolbarButton id='OTBRefresh' icon="sap-icon://refresh" tooltip="Refresh" press="onRefresh" class="buttonWithIconOnly" enabled="{coa>/RefreshEnable}" />
                                    <Button id='OTBSave' text="Save" visible="{coa>/EditRole}" enabled="{coa>/BtnEnable}" tooltip="Save Changes" press="onTableDataSave" class="applePrimaryBtn" />
                                    <Button id='OTBADD' text="Create" enabled="{coa>/BtnEnable}" visible="{coa>/EditRole}" tooltip="Add New Entry" press="onAddRec" class="appleAlternateBtn" />
                                    <Button id='OTBCopy' text="Copy" enabled="{coa>/BtnEnable}" visible="{coa>/EditRole}" tooltip="Copy and Create Entry" press="onCopyRec" class="appleAlternateBtn" />
                                    <Button id='OTBMUpload' text="Mass Update" enabled="{coa>/BtnEnable}" tooltip="Mass Upload" visible="{coa>/EditRole}" press="onMassUpdate" class="applePrimaryBtn" />
                                    <Button id="OTBDownloadTemplate" text="Download Template" visible="{coa>/EditRole}" press=".onTemplateDownload" tooltip="Download Template for FileUpload" class="appleAlternateBtn"/>
                                    <u:FileUploader id="fileUploader" sameFilenameAllowed="true" name="myFileUpload" tooltip="Upload your file"  buttonOnly="true" buttonText="Upload" class="appleAlternateBtn"  visible="{coa>/EditRole}" change="handleUploadPress" />
                                    <Button id='OTBHistory' text="Change Log" tooltip="Change Log" press="onPressHistory" visible="{coa>/EditRole}" class="appleSecondaryBtn" />
                                    <Button id='OTBDelete' text = "Delete" tooltip="Delete Entry" visible="{coa>/EditRole}" press="onDelete" class="appleDangerBtn" />
                                </OverflowToolbar>
                            </smartTable:customToolbar>
                           <t:Table id="idMPTab" visibleRowCountMode="Interactive" visibleRowCount = "17">
                                                      
                                                             <t:Column id="idsublineName" hAlign="Begin" width="12rem" filterProperty="Sub_Line_Name" sortProperty="Sub_Line_Name" >
                                        <t:customData>
                                            <core:CustomData key="p13nData" value='\{"columnKey": "Sub_Line_Name", "leadingProperty": "Sub_Line_Name",  "columnIndex": "2"}' />
                                        </t:customData>
                                        <Label id="idtoprogramelbl" text="Sub-Line Name"/>
                                        <t:template>
                                        <HBox id="hboxTO_Sub_Line_Name" class="zCoreSelectColumns" alignItems="Center" justifyContent="Start">
                                        <items>
                                            <Text id="txtsublinenme" text="{coa>Sub_Line_Name}" visible="{= ${sm4rtM0d3l>/editable} === false || ${coa>Edit} !== 7 || ${coa>KEdit} === false}" />
                                            <ComboBox   id="sublinenmeComboBox"  change="OnFieldChange" selectedKey="{coa>Sub_Line_Name}" items="{path: 'coa>/Sub_Line_Name_org', templateShareable:true}" editable="{coa>KEdit}" visible="{= ${sm4rtM0d3l>/editable} === true &amp;&amp; ${coa>Edit} === 7  &amp;&amp; ${coa>KEdit} === true}">
                                                 <core:Item key="{coa>Sub_Line_Name_org}" text="{coa>Sub_Line_Name_org}" id="sublinenputcmb"/>
                                            </ComboBox>
                                            </items>

                                        </HBox>
                                        </t:template>
                                    </t:Column>
                                     </t:Table>

                               
                        </smartTable:SmartTable>
                    </FlexBox>
                </items>
            </VBox>
        </f:content>
    </f:DynamicPage>
</mvc:View>
