<mvc:View
    controllerName="COA.coamapghsiteui.controller.Main"
    xmlns:mvc="sap.ui.core.mvc"
    displayBlock="true"
    xmlns="sap.m"
    xmlns:core="sap.ui.core"
    xmlns:f="sap.f"
    xmlns:smartFilterBar="sap.ui.comp.smartfilterbar"
    xmlns:app="http://schemas.sap.com/sapui5/extension/sap.ui.core.CustomData/1"
    xmlns:smartTable="sap.ui.comp.smarttable"
    xmlns:u="sap.ui.unified"
    xmlns:t="sap.ui.table"
>
    <f:DynamicPage id="MAppingPageDynamic" preserveHeaderStateOnScroll="true" headerExpanded="true" class="zDynamicPage">
        <f:header>
            <f:DynamicPageHeader id='DPH' class="zDynamicPageHeader ">
                <Title id="Title" text="COA - SAP CM, Site-GH Site Mapping" />
                <f:content>
                    <smartFilterBar:SmartFilterBar
                        id="smartFilterBar"
                        showGoOnFB="true"
                        useToolbar="false"
                        entitySet="CarryoverSiteMapping"
                        showClearOnFB="true"
                        initialise="onFilterBarInit"
                        enableBasicSearch="false"
                        class="contrastTextSF appleSFPrimaryBtn appleSFSecondaryBtn"
                        search="onSearch"
                    >
                        <smartFilterBar:groupConfiguration>
                            <smartFilterBar:GroupConfiguration id='GC' index="1" key="CarryoverSiteMapping" label="Input Parameters" />
                        </smartFilterBar:groupConfiguration>
                        <!-- <smartFilterBar:controlConfiguration>
                            <smartFilterBar:ControlConfiguration
                                id="chgAt"
                                key="modifiedAt"
                                index="2"
                                conditionType="{ module: 'sap.ui.comp.config.condition.DateRangeType', 
                                                         operations: { 
                                                            filter: [ {path: 'key', contains: 'YEAR',exclude:true},
                                                                        {path: 'key', contains: 'TIME',exclude:true},
                                                                        {path: 'key', contains: 'DATE'}
                                                                        ] } }"
                                visibleInAdvancedArea="true"
                            />
                        </smartFilterBar:controlConfiguration> -->
                        <smartFilterBar:customData>
                            <core:CustomData key="dateFormatSettings" value='\{"UTC":true\}' />
                        </smartFilterBar:customData>
                        <smartFilterBar:layoutData>
                            <FlexItemData id='smartLayout' shrinkFactor="0" baseSize="0%" />
                        </smartFilterBar:layoutData>
                    </smartFilterBar:SmartFilterBar>
                </f:content>
            </f:DynamicPageHeader>
        </f:header>
        <f:content>
            <VBox id="VboxContent" height="100%">
                <items>
                    <FlexBox id="table" alignItems="Center" justifyContent="Center" height="100%">
                        <smartTable:SmartTable
                            xmlns:sap.ui.comp.smarttable="sap.ui.comp.smarttable"
                            id="SiteMapTab"
                            tableBindingPath="coa>/SiteMapping"
                            header="GH Site Mapping "
                            headerLevel="H1"
                            fitContainer="true"
                            enableAutoBinding="false"
                            enableAutoColumnWidth="true"
                            width="100%"
                            direction="Column"
                            requestAtLeastFields="CM,Site"
                            height="100%"
                            entitySet="CarryoverSiteMapping"
                            class="sapUiSmallMarginBeginEnd zTable buttonWithIconOnly"
                            app:p13nDialogSettings="{group:{visible:false}}"
                            showRowCount="true"
                            initiallyVisibleFields="CM,Site,GHSite,modifiedAt,modifiedBy,createdAt,createdBy,Error"
                            placeToolbarInTable="true"
                            showFullScreenButton="true"
                            visible="true"
                            app:useSmartToggle="true"
                            app:useSmartField="false"
                            editToggled="onEditToggle"
                            editTogglable="{coa>/EditRole}"
                            useVariantManagement="false"  showVariantManagement="false"
                            useTablePersonalisation="true"
                            enableExport="true"
                            beforeExport="onBeforeExportMapping"
                            beforeRebindTable="onDataReceived"
                            fieldChange="OnFieldChange"
                            initialise="onSmartTableInit"
                        >
                            <sap.ui.comp.smarttable:customData>
                                <core:CustomData key="dateFormatSettings" value='\{"UTC":true\}' />
                            </sap.ui.comp.smarttable:customData>
                            <smartTable:customToolbar>
                                <OverflowToolbar id="OTT" design="Transparent">
                                    <ToolbarSpacer id='TS' />
                                    <Button id='OTBRefresh'  icon="sap-icon://refresh" tooltip="Refresh" press="onRefresh" class="buttonWithIconOnly" enabled="{coa>/RefreshEnable}"  />
                                    <Button id='OTBSave' text="Save" enabled="{coa>/BtnEnable}" tooltip="Save Changes" visible="{coa>/EditRole}" press="onTableDataSave" class="applePrimaryBtn"/>
                                    <Button id='OTBADD' text="Create" enabled="{coa>/BtnEnable}" visible="{coa>/EditRole}" tooltip="Add New Entry" press="onAddRec" class="appleAlternateBtn" />
                                    <Button id='OTBCopy'  text="Copy" enabled="{coa>/BtnEnable}" visible="{coa>/EditRole}" tooltip="Copy and Create Entry" press="onCopyRec" class="appleAlternateBtn" />
                                    <Button id='OTBMUpload' text="Mass Update" enabled="{coa>/BtnEnable}" tooltip="Mass Upload" visible="{coa>/EditRole}" press="onMassUpdate" class="applePrimaryBtn" />
                                    <u:FileUploader id="fileUploader" sameFilenameAllowed="true"  name="myFileUpload" tooltip="Upload your file" fileType="csv" buttonOnly="true" buttonText="Upload" class="appleAlternateBtn" visible="{coa>/EditRole}" change="handleUploadPress" />
                                    <Button id='OTBHistory' text="Change Log" tooltip="Change Log" press="onPressHistory" class="appleSecondaryBtn" />
                                    <Button id='OTBDelete' text="Delete" tooltip="Delete Entry" visible="{coa>/EditRole}" press="onDelete" class="appleDangerBtn" />
                                </OverflowToolbar>
                            </smartTable:customToolbar>
                            <t:Table id="idMPTab" visibleRowCountMode="Interactive" visibleRowCount = "17" />
                                
                        </smartTable:SmartTable>
                    </FlexBox>
                </items>
            </VBox>
        </f:content>
    </f:DynamicPage>
</mvc:View>

